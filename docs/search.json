[
  {
    "objectID": "Competing Risks in Liver Transplantation.html#the-contents",
    "href": "Competing Risks in Liver Transplantation.html#the-contents",
    "title": "Competing Risks in Liver Transplantation",
    "section": "The contents",
    "text": "The contents\n\nMotivating example\nClinical conflict\nHandling competing risks\nModel definition\nSoftware landscape\nBayesian implementation\nResults\nValidation and regulatory aligment\nCDISC workflow and traceability\nBusiness value for Medpace"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#motivating-example",
    "href": "Competing Risks in Liver Transplantation.html#motivating-example",
    "title": "Competing Risks in Liver Transplantation",
    "section": "1. Motivating example",
    "text": "1. Motivating example\nConsistent with the Estimands framework [1], a liver transplant case study should define at least the following attributes:\n\n\nPopulation: adult elective transplant recipients from a deceased donor.\n\n\n\n\nSample size: \\(N=1761\\).\nFollow up time: \\(2000-2012\\).\nBaseline attributes: age and primary liver disease.\n\n\n\n\nTreatment: Two types of liver preservation solutions (Solution A vs. Solution B).\nVariable/Endpoint: Time to graft failure due to acute/chronic organ rejection (OR).\nIntercurrent events include graft failure from:\n\n\n\n\nHepatic artery thrombosis (HAT),\nRecurrent disease (RD),\nOther reasons, including death (Other)\n\n\n\n\nSummary measure: The difference in the incidence of graft failure from OR between preservation solutions at time \\(t\\).\n\n\n\nNote: example is based on a case study from Collett [2], but the specific data are illustrative and not identical to the original source.\nprimary liver diseases include - primary biliary cirrhosis (PBC) - primary sclerosing cholangitis (PSC) and - alcoholic liver disease (ALD)\nsummary measure is purposely not precise enough to make a point.\nadditional considerations: Given the success of liver transplantation, data presents heavy censoring, with only \\(15\\%\\) (\\(n=260\\)) of individuals experienced graft failure from any cause, and \\(1.6\\%\\) (\\(n=29\\)) specifically from OR."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#clinical-conflict",
    "href": "Competing Risks in Liver Transplantation.html#clinical-conflict",
    "title": "Competing Risks in Liver Transplantation",
    "section": "2. Clinical conflict",
    "text": "2. Clinical conflict\nDifferent graft failures (competing risks) can preclude the occurrence of failure from OR (primary endpoint), effectively affecting its existence or interpretation [1, 2].\n\n\nNaive estimator:\nCan we simply treat competing risks as censored? That is the approach of the naive Kaplan-Meier (KM) estimator\nEstimation problem:\n“Censoring” competing risks causes the naive KM estimator to overestimate the cumulative incidence of the event of interest [2].\nEstimand definition:\n“The 1-KM estimate is the probability of (failing) beyond time \\(t\\), if cause \\(j\\) is the only cause of (failure), that is if all other risks were removed.” [2, 3]\n\n\n\nQuestion: How to ensure an unbiased, efficient estimate of the summary measure?\n\n\n\nEstimand definition: “the analysis is effectively an attempt to simulate a population in which (failure) from other causes is somehow either abolished or rendered independent of the risk factors for (the event of interest). The resulting effect estimate is hard to interpret and may not correspond to a meaningful estimand” [3]"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#handling-competing-risks",
    "href": "Competing Risks in Liver Transplantation.html#handling-competing-risks",
    "title": "Competing Risks in Liver Transplantation",
    "section": "3. Handling competing risks",
    "text": "3. Handling competing risks\nConsistent with the strategies for addressing intercurrent events [1], alternatives to the hypothetical strategy (targeted by naive KM estimator) include:\n\n\nCreate a single composite event,\ne.g., any cause of graft failure is considered an event.\nRestricting inference to the principal stratum,\ne.g., evaluate the effect only in patients who would not experience early HAT (e.g., within the first 48 hours) regardless of the assigned treatment.\nApply the treatment policy strategy.\ne.g., follow patients and record failure from OR regardless of competing risks (the “re-transplant” problem).\nFollow a while-alive strategy,\ne.g., assess failure from OR while the patient has not yet experienced a competing risk.\n\n\n\nThe Fine-Gray [4] and Jeong-Fine [5, 6] estimators target the while-alive strategy, modeling the cumulative incidence while subjects remain “at risk” for the primary event.\n\n\n\nCreate a single composite event, eliminates competing events, but changes the causal question/estimand [3]\nRestricting inference to the principal stratum, targets a specific subpopulation effect (e.g., LATE), which requires to “build” a challenging counterfactual, affecting interpretation and valid estimation [3].\nApply the treatment policy strategy. e.g., the “re-transplant” problem: if a patient receives a second transplant due to early HAT, and the second liver is rejected due to OR, the strategy could attribute this rejection to the first liver’s treatment, because the strategy requires that you follow the patient until you see the event of interest (This is clinically nonsensical).\nFollow a while-on-treatment strategy, e.g., in the “re-transplant” problem, if a patient receives a second transplant due to early HAT, the strategy would evaluate the risk of graft failure due to OR only while the patient still has their first graft, “stopping the clock” at the moment of re-transplant."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#model-definition-the-fine-gray-model",
    "href": "Competing Risks in Liver Transplantation.html#model-definition-the-fine-gray-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "4. Model definition: The Fine-Gray model",
    "text": "4. Model definition: The Fine-Gray model\n\nThe cause-specific subdistribution hazard function is defined as,\n\\[\nh_{j}(t) = \\lim_{\\delta t \\rightarrow 0} \\left[ \\frac{P(t \\leq T \\leq t+\\delta t, C=j) | \\{ T \\geq t \\} \\; \\text{or} \\; \\{ T \\leq t \\; and \\; C \\neq j\\}}{ \\delta t } \\right]\n\\qquad(1)\\]\n\n\nTo incorporate the influence of covariates, we assume a proportional subdistribution hazards model,\n\\[\nh_{ij}(t,\\boldsymbol{\\beta}) = exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} ) \\; h_{0j}(t)\n\\qquad(2)\\]\n\n\nLeaving the baseline hazard \\(h_{0j}(t)\\) unspecified, the parameters are estimated by maximizing the partial likelihood function for \\(m\\) causes:\n\\[\nL(\\boldsymbol{\\beta}) = \\prod_{j=1}^{m} \\prod_{i=1}^{n} \\frac{ exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} ) }{ \\sum_{l \\in R(t_{(h)})} w_{hl} \\; exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{l}} ) }\n\\qquad(3)\\]\n\n\nThe model is best interpreted in terms of the effects of explanatory variables on the cause-specific cumulative incidence function,\n\\[\nF_{ij}(t,\\boldsymbol{\\beta}) = 1 - exp \\left[ -exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} ) H_{0j}(t) \\right]\n\\qquad(4)\\]\nwhere the baseline cumulative subdistribution hazard function, \\(H_{0j}(t)\\), is estimated using the Nelson-Aalen estimate [2].\n\n\n\\(h_{j}(t)\\) is “the instantaneous event rate at time \\(t\\) from cause \\(j\\), given that an individual has not previously died from cause \\(j\\)” [2]\nThe F&G model is the industry standard, but it utilizes a risk set that is not straightforward to interpret: it continues to include subjects who have experienced a competing event as if they were still at risk for other competing events."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#model-definition-the-jeong-fine-model",
    "href": "Competing Risks in Liver Transplantation.html#model-definition-the-jeong-fine-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "4. Model definition: The Jeong-Fine model",
    "text": "4. Model definition: The Jeong-Fine model\n\nThe cause-specific subdistribution hazard function is defined as,\n\\[\nh_{j}(t) = \\lim_{\\delta t \\rightarrow 0} \\left[ \\frac{P(t \\leq T \\leq t+\\delta t, C=j) | T \\geq t }{ \\delta t } \\right]\n\\qquad(5)\\]\n\n\nTo incorporate the influence of covariates, we also assume a proportional subdistribution hazards model. Unlike Fine-Gray, we assume a parametric form for baseline hazard (e.g., Weibull):\n\\[\n\\begin{aligned}\nh_{ij}(t, \\boldsymbol{\\beta}, \\boldsymbol{\\theta}) &= exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} ) \\; h_{0j}(t, \\boldsymbol{\\theta}) \\\\\n&= exp( \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} ) \\; \\lambda \\gamma t^{\\gamma-1}\n\\end{aligned}\n\\qquad(6)\\]\n\n\nThe parameters are estimated by maximizing the full likelihood function for \\(m\\) causes,\n\\[\nL(\\boldsymbol{\\beta},\\boldsymbol{\\theta}) = \\prod_{j=1}^{m} \\prod_{i=1}^{n} h_{ij}(t,\\boldsymbol{\\beta}, \\boldsymbol{\\theta})^{\\delta_{ij}} \\; exp[ -H_{ij}(t,\\boldsymbol{\\beta}, \\boldsymbol{\\theta}) ]\n\\qquad(7)\\]\n\n\nSimilarly, the model is best interpreted in terms of the effects of covariates on the cause-specific cumulative incidence function,\n\\[\nF_{ij}(t,\\boldsymbol{\\beta},\\boldsymbol{\\theta}) = \\int_{0}^{t} f_{ij}(u,\\boldsymbol{\\beta},\\boldsymbol{\\theta}) \\; du = \\int_{0}^{t} h_{ij}(u,\\boldsymbol{\\beta},\\boldsymbol{\\theta}) \\; S(u,\\boldsymbol{\\beta},\\boldsymbol{\\theta}) \\; du\n\\qquad(8)\\]\n\n\n\\(h_{j}(t)\\) is “the instantaneous event rate at time \\(t\\) from cause \\(j\\), given that an individual has not experineces any event at time \\(t\\)” [2, 5]\nBenefit: interpretable risk set.\nDrawback: \\(F_{ij}(t)\\) usually requires numerical integration"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#software-landscape",
    "href": "Competing Risks in Liver Transplantation.html#software-landscape",
    "title": "Competing Risks in Liver Transplantation",
    "section": "5. Software landscape",
    "text": "5. Software landscape\nThe following tools are available for model estimation:\n\n\nFine-Gray: well-supported frequentist implementation via the cmprsk package [7]. The survival package [8, 9] also provides the finegray function.\nJeong-Fine: Lacks a long-standing, stable frequentist implementation; however, the cmpp package [10] (currently in development phase) provides an option.\n\n\n\nNevertheless, by leveraging Stan [11, 12] via the cmdstanr package [13], we can implement both models within a Bayesian framework.\n\n\nBenefits:\n\n\n\nCustom likelihoods\nUncertainty propagation\nIt does not rely on asymptotic theory\nPossibility of getting the full posterior distribution for \\(F_{ij}(t)\\)\n\n\n\n\n\nDrawbacks:\n\n\n\nProbabilistic Programming Language (PPL) knowledge\nJustification for priors (see Slide \\(7\\))\n\n\n\n\n\nRobust and flexible alternative to the missing frequentist implementation\nBenefits: - Allows the definition of custom likelihoods not natively available in standard packages. - Provides a posterior distribution that propagates all parameter uncertainty. - Does not rely on asymptotic theory, making it more robust in small-sample scenarios. - The Bayesian J&F model yields the full posterior distribution for the cumulative incidence function, \\(F_{ij}(t)\\).\nDrawbacks:\n\nFrequentist analysis requires optimization knowledge."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#bayesian-implementation-the-fine-gray-model",
    "href": "Competing Risks in Liver Transplantation.html#bayesian-implementation-the-fine-gray-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "6. Bayesian implementation: The Fine-Gray model",
    "text": "6. Bayesian implementation: The Fine-Gray model\nThe partial log-likelihood for Equation 3 is,\n\\[\n\\log L(\\boldsymbol{\\beta}) = \\sum_{j=1}^{m} \\sum_{i=1}^{n} \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{i}} \\; \\cdot \\log \\left\\{ \\sum_{l \\in R(t_{(h)})} exp \\left[ \\log(w_{hl}) + \\boldsymbol{\\beta_{j}'} \\boldsymbol{x_{l}} \\right] \\right\\}\n\\qquad(9)\\]\nSorting data in descending order by event times, the Bayesian model is as follows:\n```{r}\nStanModel = \"\ndata {\n  int&lt;lower=0&gt; m; // number of causes\n  int&lt;lower=0&gt; n; // num obs\n  int&lt;lower=0&gt; q; // num covariates\n  vector[n] t;    // time\n  matrix[n,m] s;  // cause of failure\n  matrix[n,q] X;  // covariates\n  vector[n] w;    // weights\n}\nparameters {\n  matrix[q,m] beta; // beta[covariate,cause]\n}\nmodel {\n  // priors\n  to_vector(beta) ~ normal(0,2);\n  \n  // risk score\n  matrix[n,m] rs = X*beta;\n  \n  // partial log-likelihood\n  for( j in 1:m ){\n    for( i in 1:n ) {\n      if( s[i,j]==1 ){\n        real log_den = log_sum_exp( log(w[1:i]) + rs[1:i, j] );\n        target += rs[i,j] - log_den;\n      }\n    }\n  }\n}\n```"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#bayesian-implementation-the-jeong-fine-model",
    "href": "Competing Risks in Liver Transplantation.html#bayesian-implementation-the-jeong-fine-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "6. Bayesian implementation: The Jeong-Fine model",
    "text": "6. Bayesian implementation: The Jeong-Fine model\nThe full log-likelihood for Equation 7 is,\n\\[\n\\log L(\\boldsymbol{\\beta},\\boldsymbol{\\theta}) = \\sum_{j=1}^{m} \\sum_{i=1}^{n} \\delta_{ij} \\cdot \\log h_{ij}(t,\\boldsymbol{\\beta},\\boldsymbol{\\theta}) - H_{ij}(t,\\boldsymbol{\\beta},\\boldsymbol{\\theta})\n\\qquad(10)\\]\nand the Bayesian model is defined as:\n```{r}\nStanModel = \"\nfunctions{\n  // cause-specific log hazard function\n  real log_hij( real t, real rs, real lambda, real gamma ){\n    return( rs + log(lambda) + log(gamma) + (gamma-1)*log(t) );\n  }\n  // cause-specific cummulative hazard function\n  real Hij( real t, real rs, real lambda, real gamma ){\n    return( exp( rs ) * lambda * t^gamma ); \n  }\n  // overall log-survival function\n  real log_S( real t, vector rs, vector lambda, vector gamma, int m ) {\n    real oSt = 0;\n    for (j in 1:m) {\n      oSt += Hij(t, rs[j], lambda[j], gamma[j]);\n    }\n    return(-oSt);\n  }\n  // cause specific log-density\n  real log_fij( real t, int j, vector rs, vector lambda, vector gamma, int m ){\n    return ( log_hij( t, rs[j], lambda[j], gamma[j] ) + \n             log_S( t, rs, lambda, gamma, m ) );\n  }\n  // Integrand for the density function\n  real fij(real t, real xc, array[] real theta, array[] real x_r, array[] int x_i) {\n    // parameters and data\n    int j = x_i[1];\n    int m = x_i[2];\n    vector[m] rs = to_vector( theta[1:m] );\n    vector[m] lambda = to_vector( theta[(m+1):(2*m)] );\n    vector[m] gamma =  to_vector( theta[(2*m+1):(3*m)] );\n    return( exp( log_fij( t, j, rs, lambda, gamma, m ) ) );\n  }\n}\ndata {\n  // fitting data\n  int&lt;lower=0&gt; m;       // number of causes\n  int&lt;lower=0&gt; n;       // num obs\n  int&lt;lower=0&gt; q;       // num covariates\n  vector[n] t;          // time\n  matrix[n,m] s;        // cause of failure\n  matrix[n,q] X;        // covariates\n  \n  // For Marginal Approximation\n  int&lt;lower=1&gt; ms;      // Number of Monte Carlo draws (e.g., 100)\n  int&lt;lower=0&gt; ns;      // number of time samples\n  vector[ns] ts;         // time samples\n  matrix[1,q] XS;       // covariates for simulation\n}\nparameters {\n  matrix[q,m] beta;           // beta[covariate,cause]\n  vector&lt;lower=0&gt;[m] lambda;  // lambda[cause]\n  vector&lt;lower=0&gt;[m] gamma;   // gamma[cause]\n}\nmodel {\n  // priors\n  to_vector(beta) ~ normal(0,2);\n  lambda ~ exponential(2);\n  gamma ~ gamma(8,5); \n  \n  // risk score\n  matrix[n,m] rs = X*beta;\n  \n  // log-likelihood\n  for( j in 1:m ){\n    for( i in 1:n ){\n      target += s[i,j] * log_hij( t[i], rs[i,j], lambda[j], gamma[j] ) -\n                Hij( t[i], rs[i,j], lambda[j], gamma[j] );\n    }\n  }\n}\ngenerated quantities {\n  matrix[ns,m] Fij_MC;\n  matrix[ns,m] Fij_I;\n  \n  // risk score\n  vector[m] rs = to_vector(XS*beta);\n  \n  // flatten parameters \n  array[3*m] real flat_theta;\n  for (j in 1:m) {\n    flat_theta[j] = rs[j];\n    flat_theta[m+j] = lambda[j];\n    flat_theta[2*m+j] = gamma[j];\n  }\n  \n  for (i in 1:ns) {\n    for (j in 1:m) {\n    \n      // Monte Carlo integration\n      real fij_sum = 0;\n      for (k in 1:ms) {\n        real u = uniform_rng(0, ts[i]);\n        fij_sum += exp(log_fij(u, j, rs, lambda, gamma, m));\n      }\n      Fij_MC[i,j] = ts[i] * (fij_sum / ms); \n      // Fij = t[i] * p(t[i])\n      \n      // Double Exponential Quadrature integration\n      Fij_I[i,j] = integrate_1d( fij, 0.0, ts[i], flat_theta, {0.0}, {j,m} );\n      \n    }\n  }\n}\n\"\n```"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-data-description",
    "href": "Competing Risks in Liver Transplantation.html#results-data-description",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Data description",
    "text": "7. Results: Data description\n\n\nSet environment\n# working environment ####\n\n# cleaning R start\nrm(list=ls()); gc()\n\n# loading libraries\nlibraries = c( \n  # general purpose\n  'here','tidyverse','rtables','gt','cowplot',\n  \n  # frequentist implementations\n  'survival','cmprsk','tidycmprsk','ggsurvfit',\n  \n  # Bayesian implementations\n  'cmdstanr', 'coda','posterior','bayesplot'\n) \nsapply(libraries, require, character.only=T)\n\n\n\n\nDataset load\n# Source data ####\n\n# load data\nrd  = file.path( here(), 'data', 'liver transplant example.dat')\nds = rd %&gt;%\n  read.table( header=T )\n\n              \n# data structure\n# str(ds)\n# \n# Note:\n#   patient: patient number\n#   age: age at baseline\n#   treatment: 1=Solution A, 2=Solution B\n#   disease: primary liver disease, 1=PBC, 2=PSC, 3=ALD\n#   time: time to cause of graft failure\n#   status: 1=event, 0=censored\n#   cof: cause of graft failure, 0=functioning graft, 1=rejection, 2=thrombosis, 3=recurrent disease, 4=other\n\n\n# convert to factor\nds = ds %&gt;%\n  mutate(\n    treatment_label = treatment,\n    disease_label = disease,\n    cof_label = cof ) %&gt;%\n  mutate_at( \n    .vars = vars(treatment_label), \n    .funs = factor,\n    levels = 1:2, \n    labels = c('Solution A','Solution B')\n  ) %&gt;%\n  mutate(\n    treatment_label = \n      fct_relevel( treatment_label, \n                   c('Solution B','Solution A'))) %&gt;%\n  mutate_at( \n    .vars = vars(disease_label), \n    .funs = factor,\n    levels = 1:3, \n    labels = c('PBC','PSC','ALD') ) %&gt;%\n  mutate(\n    disease_label = \n      fct_relevel( disease_label, \n                   c('ALD','PBC','PSC'))) %&gt;%\n  mutate_at( \n    .vars = vars(cof_label), \n    .funs = factor,\n    levels = 0:4, \n    labels = c('Functioning graft', \n               'Organ Rejection', \n               'Hepatic Artery Thrombosis', \n               'Recurrent Disease', \n               'Other') )\n\n\n\n\nDemographics table (DMT01)\n## Demographics (DMT01) #####\n\n# calculation and formatting function\nf_summary = function(x) {\n  if ( is.numeric(x) ) {\n    in_rows(\n      \"n\" = rcell( sum(!is.na(x)), format = \"xx\"),\n      \"Mean (SD)\" = rcell( c(mean(x, na.rm=T), sd(x, na.rm=T)), format = \"xx.x (xx.x)\"),\n      \"Median\" = rcell( median(x, na.rm=T), format = \"xx.x\"),\n      \"Min - Max\" = rcell( range(x, na.rm=T), format = \"xx.x - xx.x\")\n    )\n  } else if ( is.factor(x) ) {\n    tab = c( table(x) )\n    do.call( \n      in_rows, \n      c( \"n\" = rcell( sum(tab), format = \"xx\" ),\n         lapply(tab, rcell, format = \"xx\" ) ) )\n  } else {\n    stop(\"type not supported\")\n  }\n}\n\n# table\nbasic_table( show_colcounts=T ) %&gt;%\n  split_cols_by( \n    var = \"treatment_label\",\n    ref_group = \"Solution B\") %&gt;%\n  add_overall_col(\"All Patients\") %&gt;%\n  analyze( \n    vars = c('age','disease_label'), \n    afun = f_summary,\n    var_labels = c('Age (yr)','Liver Disease') \n  ) %&gt;%\n  build_table( df=ds )\n\n\n                Solution B    Solution A    All Patients\n                  (N=694)      (N=1067)       (N=1761)  \n————————————————————————————————————————————————————————\nAge (yr)                                                \n  n                 694          1067           1761    \n  Mean (SD)     53.6 (9.4)    53.3 (9.3)     53.5 (9.3) \n  Median           55.0          54.0           55.0    \n  Min - Max     18.0 - 74.0   18.0 - 74.0   18.0 - 74.0 \nLiver Disease                                           \n  n                 694          1067           1761    \n  ALD               200           733           933     \n  PBC               400           69            469     \n  PSC               94            265           359"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-data-description-1",
    "href": "Competing Risks in Liver Transplantation.html#results-data-description-1",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Data description",
    "text": "7. Results: Data description\n\n\nDeaths table (DTHT01)\n## Deaths (DTHT01) #####\n\n# calculation and formatting functions\nevent_count = function(x, .N_col) {\n  tab = c( table(x) )\n  in_rows(\n    \"Total number of events\" = rcell( tab[2] * c(1, 1 / .N_col), format = \"xx (xx.x%)\" )\n  )\n}\n\ncof_count = function(x, .N_col) {\n  tab = c( table(x) )\n  tab = tab[ names(tab) != \"Functioning graft\" ]\n  do.call( \n    in_rows, \n    c( \"n\" = rcell( sum(tab), format = \"xx\" ),\n       lapply( \n         tab,\n         function(xi){ rcell(xi * c(1, 1 / .N_col), format = \"xx (xx.x%)\") } \n       ) ) )\n}\n\n\n# table\nbasic_table( show_colcounts=T ) %&gt;%\n  split_cols_by( \n    var = \"treatment_label\", \n    ref_group = \"Solution B\") %&gt;%\n  add_overall_col(\"All Patients\") %&gt;%\n  analyze( \n    vars = \"status\", \n    afun = event_count, \n    show_labels = \"hidden\" ) %&gt;%\n  analyze( \n    vars = \"cof_label\", \n    afun = cof_count, \n    var_labels = \"Cause of graft failure\", \n    show_labels = \"visible\" ) %&gt;%\n  build_table( df=ds )\n\n\n                              Solution B    Solution A    All Patients\n                                (N=694)      (N=1067)       (N=1761)  \n——————————————————————————————————————————————————————————————————————\nTotal number of events        106 (15.3%)   159 (14.9%)   265 (15.0%) \nCause of graft failure                                                \n  n                               104           156           260     \n  Organ Rejection              14 (2.0%)     15 (1.4%)     29 (1.6%)  \n  Hepatic Artery Thrombosis    32 (4.6%)     41 (3.8%)     73 (4.1%)  \n  Recurrent Disease            14 (2.0%)     28 (2.6%)     42 (2.4%)  \n  Other                        44 (6.3%)     72 (6.7%)     116 (6.6%) \n\n\n\nfrom TLG Catalog: - Table Demography DMT01 - Table Deaths DTHT01"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-frequentist-fine-gray-model",
    "href": "Competing Risks in Liver Transplantation.html#results-frequentist-fine-gray-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Frequentist Fine-Gray model",
    "text": "7. Results: Frequentist Fine-Gray model\nAbout the fitting process:\n\n\nIt used the cmprsk package [7] and the tidy-wrapper tidycmprsk [14].\nIt runs all causes in a second\n\n\n\n\n\nFine-Gray regression (Equivalence: COXT01)\n### Bayseian Fine-Gray regression ####\n# (Equivalence: COXT01) \n\n# load ADR?\nhr_cof = readRDS( \n  file.path( \n    here(),\n    'results',\n    paste0('ARD_B_FG.RDS') ) )\n\n\nhr_cof %&gt;%\n  select( \n    'Effect/Covariate Included in the model', \n    'Hazard ratio', \n    lower, \n    upper, \n    'P(0.95&lt; HR &lt;1.1)', \n    cof_label ) %&gt;%\n  filter( cof_label == 'Organ Rejection' ) %&gt;%\n  group_by( cof_label ) %&gt;%\n  gt() %&gt;%\n  tab_spanner(\n    label = \"90% CI\",\n    columns = c('lower','upper')\n  ) %&gt;%\n  tab_spanner(\n    label = \"Treatment effect adjusted for covariate\",\n    columns = c('Hazard ratio','lower','upper','P(0.95&lt; HR &lt;1.1)')\n  ) %&gt;%\n  fmt_number( \n    columns = 2:4,\n    decimal = 2\n  ) %&gt;%\n  fmt_number( \n    columns = 5,\n    decimal = 4\n  ) %&gt;%\n  sub_missing( missing_text = \" \" )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTreatment effect adjusted for covariate\n\n\n\nEffect/Covariate Included in the model\nHazard ratio\n\n90% CI\n\nP(0.95&lt; HR &lt;1.1)\n\n\nlower\nupper\n\n\n\n\nOrgan Rejection\n\n\nSolution A vs control (Solution B)\n0.65\n0.29\n1.21\n0.0605\n\n\nAge\n0.96\n0.93\n0.99\n0.6055\n\n\nDisease PBC vs ALD\n0.69\n0.25\n1.38\n0.0663\n\n\nDisease PSC vs ALD\n1.17\n0.49\n2.16\n0.1340\n\n\n\n\n\n\n\n\n\n\nfrom TLG Catalog: - Table Efficacy COXT01 - Graphs Efficacy KMG01"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-frequentist-fine-gray-model-1",
    "href": "Competing Risks in Liver Transplantation.html#results-frequentist-fine-gray-model-1",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Frequentist Fine-Gray model",
    "text": "7. Results: Frequentist Fine-Gray model\n\n\n\nFine-Gray failures plot (Equivalence: KMG01)\n### Fine-Gray failures plot ####\n# (Equivalence: KMG01)\n\n# require(ggsurvfit)\n\ncof = c('Organ Rejection', \n        'Hepatic Artery Thrombosis', \n        'Recurrent Disease', \n        'Other')\n\nfor( j in 1:max(ds$cof) ){\n  assign( \n    paste0('F', j),\n    cuminc( \n      Surv(time, cof_label) ~ treatment_label, \n      data = ds ) %&gt;%\n      ggcuminc( outcome = cof[j] ) +\n      add_confidence_interval() +\n      add_risktable() +\n      scale_ggsurvfit( \n        x_scales = list(breaks=seq(0,max(ds$time), by=500)),\n        y_scales = list(limits=c(0,0.15)) )\n  )\n}\n\nF1"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-bayesian-fine-gray-model",
    "href": "Competing Risks in Liver Transplantation.html#results-bayesian-fine-gray-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Bayesian Fine-Gray model",
    "text": "7. Results: Bayesian Fine-Gray model\nAbout the fitting process:\n\n\nIt used Stan [11, 12] via the cmdstanr package [13].\nIt runs all causes in \\(250-300\\) seconds (\\(4.2-5\\) minutes),\nIt produces healthy sampling chains\n\n\n\n\n\nBayesian Fine-Gray regression (Equivalence: COXT01)\n### Fine-Gray regression ####\n# (Equivalence: COXT01) \n\n# load ADR?\nhr_cof = readRDS( \n  file.path( \n    here(),\n    'results',\n    paste0('ARD_B_FG.RDS') ) )\n\n\nhr_cof %&gt;%\n  select( \n    'Effect/Covariate Included in the model', \n    'Hazard ratio', \n    lower, \n    upper, \n    'P(0.95&lt; HR &lt;1.1)', \n    cof_label ) %&gt;%\n  filter( cof_label == 'Organ Rejection' ) %&gt;%\n  group_by( cof_label ) %&gt;%\n  gt() %&gt;%\n  tab_spanner(\n    label = \"90% CI\",\n    columns = c('lower','upper')\n  ) %&gt;%\n  tab_spanner(\n    label = \"Treatment effect adjusted for covariate\",\n    columns = c('Hazard ratio','lower','upper','P(0.95&lt; HR &lt;1.1)')\n  ) %&gt;%\n  fmt_number( \n    columns = 2:4,\n    decimal = 2\n  ) %&gt;%\n  fmt_number( \n    columns = 5,\n    decimal = 4\n  ) %&gt;%\n  sub_missing( missing_text = \" \" )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTreatment effect adjusted for covariate\n\n\n\nEffect/Covariate Included in the model\nHazard ratio\n\n90% CI\n\nP(0.95&lt; HR &lt;1.1)\n\n\nlower\nupper\n\n\n\n\nOrgan Rejection\n\n\nSolution A vs control (Solution B)\n0.65\n0.29\n1.21\n0.0605\n\n\nAge\n0.96\n0.93\n0.99\n0.6055\n\n\nDisease PBC vs ALD\n0.69\n0.25\n1.38\n0.0663\n\n\nDisease PSC vs ALD\n1.17\n0.49\n2.16\n0.1340\n\n\n\n\n\n\n\n\n\n\nfrom TLG Catalog: - Table Efficacy COXT01"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model",
    "href": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Bayesian Jeong-Fine model",
    "text": "7. Results: Bayesian Jeong-Fine model\nAbout the fitting process:\n\n\nIt used Stan [11, 12] via the cmdstanr package [13].\nIt runs all causes in \\(930-970\\) seconds (\\(15.5-16.2\\) minutes),\nIt produces healthy sampling chains,\n… but the order and reference level of some variables can lead to non-finite integrals\n\n\n\nfrom TLG Catalog: - Table Efficacy COXT01 - Graphs Efficacy KMG01"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model-1",
    "href": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model-1",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Bayesian Jeong-Fine model",
    "text": "7. Results: Bayesian Jeong-Fine model\n\n\nBayesian Jeong-Fine regression (Equivalence: COXT01)\n### Jeong-Fine regression ####\n# (Equivalence: COXT01) \n\n# load ADR?\nhr_cof = readRDS( \n  file.path( \n    here(),\n    'results',\n    paste0('ARD_B_JF.RDS') ) )\n\n\nhr_cof %&gt;%\n  select( \n    'Effect/Covariate Included in the model', \n    'Hazard ratio', \n    lower, \n    upper, \n    'P(0.95&lt; HR &lt;1.1)', \n    cof_label ) %&gt;%\n  filter( cof_label == 'Organ Rejection' ) %&gt;%\n  group_by( cof_label ) %&gt;%\n  gt() %&gt;%\n  tab_spanner(\n    label = \"90% CI\",\n    columns = c('lower','upper')\n  ) %&gt;%\n  tab_spanner(\n    label = \"Treatment effect adjusted for covariate\",\n    columns = c('Hazard ratio','lower','upper','P(0.95&lt; HR &lt;1.1)')\n  ) %&gt;%\n  fmt_number( \n    columns = 2:4,\n    decimal = 2\n  ) %&gt;%\n  fmt_number( \n    columns = 5,\n    decimal = 4\n  ) %&gt;%\n  sub_missing( missing_text = \" \" )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTreatment effect adjusted for covariate\n\n\n\nEffect/Covariate Included in the model\nHazard ratio\n\n90% CI\n\nP(0.95&lt; HR &lt;1.1)\n\n\nlower\nupper\n\n\n\n\nOrgan Rejection\n\n\nSolution A vs control (Solution B)\n0.63\n0.30\n1.14\n0.0530\n\n\nAge\n0.95\n0.92\n0.98\n0.5232\n\n\nDisease PBC vs ALD\n0.72\n0.28\n1.43\n0.0777\n\n\nDisease PSC vs ALD\n1.02\n0.43\n1.91\n0.1247\n\n\nScale\n0.01\n0.00\n0.05\n\n\n\n\nShape\n0.50\n0.38\n0.63"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model-2",
    "href": "Competing Risks in Liver Transplantation.html#results-bayesian-jeong-fine-model-2",
    "title": "Competing Risks in Liver Transplantation",
    "section": "7. Results: Bayesian Jeong-Fine model",
    "text": "7. Results: Bayesian Jeong-Fine model\n\n\nBayesian Jeong-Fine failures plot (Equivalence: KMG01)\n### Jeong-Fine failures plot ####\n# (Equivalence: KMG01)\n\n# load ADR?\nFij_MC = readRDS( \n  file.path( \n    here(),\n    'results',\n    paste0('ARD_B_JF_cumincMC.RDS' ) ) )\n\nFij_I = readRDS( \n  file.path( \n    here(),\n    'results',\n    paste0('ARD_B_JF_cumincI.RDS') ) )\n\nt = seq(1, max(ds$time), by=3)\n\npar(mfrow=c(2,2))\nfor( j in 1:4 ){\n  idx = str_detect( Fij_MC$variable, paste0(j,'[:punct:]$') )\n  plot( t, Fij_I$mean[idx], type='l', lwd=4, lty=1, ylim=c(0,0.15),\n        ylab = \"Cumulative incidence\" ,\n        xlab = \"Time\" )\n  lines( t, Fij_MC$mean[idx], col='red', lty=2)\n  legend( 'topleft', bty='n', col=c('white','black','red'), lty=c(1,1,2),\n          legend=c( paste0('P(C=',j,') = ', round( tail(Fij_I$mean[idx], 1), 2) ),\n                    'Double Exponential Quadrature', \n                    'Monte Carlo approx') )\n}"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#validation-and-regulatory-aligment",
    "href": "Competing Risks in Liver Transplantation.html#validation-and-regulatory-aligment",
    "title": "Competing Risks in Liver Transplantation",
    "section": "8. Validation and regulatory aligment",
    "text": "8. Validation and regulatory aligment\nPer the FDA Draft Guidance on Bayesian Methodology [15], utilizing the Jeong-Fine model [5, 6] requires the creation of two core documents:\n\n\nA detailed Bayesian analysis plan (BAP)\nA comprehensive simulation report (if necessary)\n\n\n\nTogether, they should allow the regulatory authority to assess:\n\n\nThe proposed prior distribution, e.g., “flavors” and scenarios\nThe validity of the likelihood, already required for SAP\nThe posterior and proposed success criteria, that is, \\(P(d&gt;a)&gt;c\\)\nThe appropriateness of the operating characteristics of the trial, such as FWER, bias, MSE.\nSoftware and reproducibility, ensuring GCP-compliant environments\n\n\n\n\n\nThe proposed prior distribution\n\n\nDistinguishing between Design and Analysis priors.\nCategorizing by “flavor”: Noninformative, Weakly informative, Skeptical, or Informative.\nAssessing results under various scenarios.\n\n\nThe validity of the likelihood\n\n\nJustifying the parametric assumptions for the J&F subdistribution hazard.\n\n\nThe posterior and proposed success criteria\n\n\nIts definition, e.g., \\(P(d&gt;a)&gt;c\\) (where \\(d\\) is the treatment effect, \\(a\\) is the clinical relevance threshold, and \\(c\\) is the probability requirement).\n\n\nThe appropriateness of the operating characteristics of the trial\n\n\nThe justification for sample size and associated power.\nThe FWER (Type I Error) calibration.\nThe assessment of bias, MSE, coverage probability, and width of confidence intervals across a range of scenarios.\n\n\nSoftware and Reproducibility\n\n\nmaking sure to use GCP-compliant environments (e.g., cmdstanr).\nProviding code to allow verification of sampling properties and reliability."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#cdisc-workflow-and-traceability",
    "href": "Competing Risks in Liver Transplantation.html#cdisc-workflow-and-traceability",
    "title": "Competing Risks in Liver Transplantation",
    "section": "9. CDISC workflow and traceability",
    "text": "9. CDISC workflow and traceability\nWhile this example utilized pre-processed data, a regulatory-grade workflow requires a rigorous CDISC-compliant pipeline to ensure end-to-end traceability.\n\nKey “missing” steps from this analysis include:\n\n\nSDTM Mapping: Converting raw CRF and EDC data into standardized domains.\nADaM Derivation: Building Analysis Data Models (ADSL, ADTTE).\nARS/ARD Derivation: Capturing analysis results and metadata in a machine-readable format.\nTLG/TLF Production: Generating (additional) validated Tables, Listings, and Graphs/Figures from ARD.\nand more\n\n\n\n\n\nSDTM Mapping:: Mapping raw data to domains like DM (Demographics), DS (Disposition), and CE (Clinical Events). For modern R-based mapping, the sdtm.oak package [16] provides a framework for modular, reusable mapping scripts.\nADaM Derivation:: Using the admiral package [17] to handle complex censoring logic for competing risks, distinguishing between ‘target events’, ‘competing events’, and ‘right-censoring’.\nARS/ARD Derivation: Analysis Results Standard (ARS) with its Analysis Results Data (ARD) is a standardized intermediate layer between ADaM and the final output, facilitating automation, reproducibility, and traceability.\nTLG/TLF Production:: Regulatory-grade displays produced using the NEST suite (rtables, tern, teal). By consuming standardized ARD, the process becomes “metadata-driven,” ensuring the final output is programmatically linked to the underlying ADaM for auditability."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#business-value-for-medpace",
    "href": "Competing Risks in Liver Transplantation.html#business-value-for-medpace",
    "title": "Competing Risks in Liver Transplantation",
    "section": "10. Business value for Medpace",
    "text": "10. Business value for Medpace\nImplementing advanced Bayesian models differentiates Medpace as a high-tier technical partner, ready to propose complex designs under the FDA Complex Innovative Trial Design (CID) program\nSpecifically, the Bayesian Jeong-Fine model provides:\n\n\nDirect interpretability for clinicians and regulatory bodies,\nIntegrated handling of missing data [15]\nEfficiency via information borrowing [15]\nStable extrapolation and prediction capabilities\nRobustness in small-sample settings\n\n\n\n\nDirect Interpretability for clinicians and regulatory bodies\nThe Bayesian J&F model provides the direct cumulative Incidence. This is far more intuitive for clinicians and regulatory reviewers making risk-benefit assessments.\nIntegrated handling of missing data\nThe Bayesian J&F model can treat missing data as part of the parameter estimation process. This could provide a more robust posterior distribution than standard imputation, reducing the risk of biased results in high-attrition trials.\nEfficiency via information borrowing\nThe Bayesian J&F model has ability to incorporate informative priors (from historical data or RWE) which can potentially reduce the sample size required for current trials\nStable extrapolation and prediction capabilities\nThe parametric nature of the Bayesian J&F model allows for stable prediction beyond the last observed event time.\nRobustness in small-sample settings\nIn scenarios where frequentist asymptotic assumptions fail, e.g., in cases of rare diseases where there is small \\(N\\) or few events, the Bayesian J&F remains valid."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#thank-you",
    "href": "Competing Risks in Liver Transplantation.html#thank-you",
    "title": "Competing Risks in Liver Transplantation",
    "section": "Thank you",
    "text": "Thank you\n\nTo conclude I can say that,\n\nI can bring my PhD-level Bayesian expertise to the Leuven office.\nI have the CDISC knowledge to make these analyses “submission-ready” from day one.\nI am ready to operationalize these workflows starting from April."
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#questions",
    "href": "Competing Risks in Liver Transplantation.html#questions",
    "title": "Competing Risks in Liver Transplantation",
    "section": "Questions?",
    "text": "Questions?"
  },
  {
    "objectID": "Competing Risks in Liver Transplantation.html#references",
    "href": "Competing Risks in Liver Transplantation.html#references",
    "title": "Competing Risks in Liver Transplantation",
    "section": "References",
    "text": "References\n\n\n1. ICH (2019) E9(R1) addendum on estimands and sensitivity analysis in clinical trials to the E9 guideline on statistical principles for clinical trials. 1–22\n\n\n2. Collett D (2023) Modelling survival data in medical research. Chapman; Hall/CRC\n\n\n3. Hernán M, Robins J (2025) Causal inference: What if, 1st ed. Chapman; Hall/CRC\n\n\n4. Fine JP, Gray RJ (1999) A proportional hazards model for the subdistribution of a competing risk. Journal of the American Statistical Association 94(446):496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\n5. Jeong Jong-Hyeon, Fine J (2006) Direct parametric inference for the cumulative incidence function. Journal of the Royal Statistical Society 55(2):187–200\n\n\n6. Jeong Jong-Hyeon, Fine J (2007) Parametric regression on cumulative incidence function. Biostatistics 8(2):184–196. https://doi.org/10.1093/biostatistics/kxj040\n\n\n7. Gray B (2024) Cmprsk: Subdistribution analysis of competing risks\n\n\n8. Terry M. Therneau, Patricia M. Grambsch (2000) Modeling survival data: Extending the Cox model. Springer, New York\n\n\n9. Therneau TM (2026) A package for survival analysis in r\n\n\n10. Ezzatabadipour H (2025) Cmpp: Direct parametric inference for the cumulative incidence function in competing risks\n\n\n11. Stan Development Team. (2026) Stan userś guide, version 2.38.0. Vienna, Austria\n\n\n12. Stan Development Team. (2026) Stan reference manual, version 2.38.0. Vienna, Austria\n\n\n13. Gabry J, C̆es̆novar R, Johnson A, Bronder S (2025) Cmdstanr: R interface to ’CmdStan’\n\n\n14. Sjoberg DD, Fei T (2025) Tidycmprsk: Competing risks estimation\n\n\n15. DHS, FDA, CDER, CBER (2026) Use of bayesian methodology in clinical trials of drug and biological products, draft guidance for industry. 1–29\n\n\n16. Ganapathy R, Forys A, Manukyan E, et al (2025) Sdtm.oak: SDTM data transformation engine\n\n\n17. Straub B, Bundfuss S, Bearham M, et al (2026) Admiral: ADaM in r asset library\n\n\n\n\n\n\nCompeting Risks, a Bayesian parametric alternative | Jose Manuel Rivera Espejo | Github Repository"
  }
]